# emaize 做proposal PPT用
#projects/emaize



- [ ] **做PPT，周三组会上讲**


# 目标：
### 预测1200*30，其中1200*2用来做验证
- [ ] **展示project design**
24个中国最优秀品种，自交多代，选出1404个，和30个优秀的品系杂交，其中200个作为初赛的，其他的复赛的（结合PPT）
 **最终测试验证的是jing724和zheng58与30个父本杂交的！**这些亲本的SNP和性状和更多数据能拿到吗？（还是亲本SNP只能推断？）
### 通过挑选显著相关的SNP及其组合，发现新的与性状相关的基因
### 预测环境的影响，同一子代在不同环境下的差异，以及发现表现稳健的子代

# 数据 
**目前已获得的数据**
- 6210个杂交子代的SNP数据，经过新的过滤流程，558万
- 接下来会给所有36000个子代的SNPs
- 1404+30个亲本的SNPs数据，不需要我们再推断了
- 亲本性状
- 接下来也可以获得完整的基因组数据
- 五个地点的相同的6210个子代的性状数据，以及1404+30个亲本的环境数据。环境情况正在整理中。
- RNA-seq数据，目前亲本，接下来会有子代的

## SNP数据
### 子代SNPs
**基因型数据，我们这边又重新建立一套约558万的SNP数据集，包括所有子代和亲本的，其实是全基因组的再imputation**
588M SNP的6210个hybrids的基因型。这里面的hybrid ID是seqname，和表型数据的lineID对应关系，见Parent_ID_ALL.txt文件。
都在/Share/home/shibinbin/data/emaize/new_snp
[image:E5989231-9CCD-44B5-89CA-FF16B9A75E68-733-0000827A22F62D20/781517801103_.pic_hd.jpg]
竞赛用的190就是基于第一步的1800万过滤来的，只是更稀疏
结构变异需要的全基因组数据是有的
### 亲本SNP
**这是所有亲本的588M SNP基因型，207个母本，30个父本，1221个剩下的母本（female36K)**
**根据Parent_ID_ALL.txt可以对应回去**

## 性状数据
### 五个地点的相同的6210个子代的性状数据，以及1404+30个亲本的环境数据。环境情况正在整理中。
与推断的亲本的性状比较，画图

## RNA-seq数据
RNA-seq目前只是针对自交系，杂交种还没测，这个数据对于预测应该用不少，后续我们加测杂交种后，就可以用了。
**RNA-seq确实会提高结果**，有这样的研究！但是很多时候我们得不到这样的数据，而且数据在不同组织中可能不一样




# 特征选择
## 降维
- **首先**根据这个流程，我们不需要再根据MAF来过滤SNP了[image:523DC609-3C54-40C0-927B-C474EF37CAAF-733-0000961B020DF7D9/781517801103_.pic_hd.jpg]
- **LD decay**  一般r2小于0.1  用于选feature。全基因组的LD区域基本认为统一，计算不同的区间划分大小下的$r^2$，得到LD decay曲线，一般认为$r^2$降到0.1以下即可。
[image:E066EBE2-F179-4D28-B6DF-C76F2F65E1B3-733-00009702EAA3FA74/14801517840083_.pic_hd.jpg]
然后可以从每个区间里选SNP，比如聚类选出来聚类中心
- **聚类法**
- LD区间方法虽然常用，但是只能一块儿一块儿考虑，无法把比较远的可能有作用的区域考虑到一起。
如果有直接聚类的方法就直接聚类。比如DACE，LSH+DP-means。
**主要步骤如下：**我们先做random projection，用LSH方法通过设置一定的hash size将不同的feature映射到hash value，通过合理地设置hash size将每类保持在1000-4000之间以取得较好的聚类效果。然后对hash value进行DP-means聚类，获得每类的聚类中心，再对聚类中心进行random projection和LSH，计算hash value，将相近的归到同一类，合并feature，减少类的个数。重复以上过程，知道聚类中心距离足够远，不能再通过LSH合并，即得到合适的类。
Dirichilet Process的**好处**包括：使用迭代的方法保证结果，可以保证距离较远的feature不会聚到一类，避免了常规聚类方法的问题。不事先指定聚类个数，非监督学习。可以处理极大规模的数据，对于我们的问题非常有意义。
LD显然快的多，如果DACE的速度是可接受的，用聚类也许可以摆脱之前的研究的问题取得更好的结果。


## GWAS
**目前GWAS的问题**一个一个挑的，全部数据做的话计算量太大，为此我们使用一个折中的办法。（**展示上次PPT LASSO+MR**）

## 辅助挑选SNP
- [ ] **eQTL？**  excel表格？

- [ ] **Maize annotation?**

## 新feature
### 亲本的SNP
**首先**可以帮助挑选feature，亲本的样本间距离更远，可以做feature selection，但是样本太少（虽然1404+30我们都有，但是有label的只有237个）
**其次可以加到MR中**，用亲本衡量相似性，但是这组feature可能和之前的十万个基本相似，可能冗余。
### 未知性状样本的SNP
30*1204
**可以做非监督学习**，用于算LD，或者做聚类，帮助更好地将已知样本聚类，按理说样本越多效果应该是越好的。

### 结构变异需要的全基因组数据？
结构变异导致基因尺度都改变？用什么衡量？r2?

### 第一名PPT第十二页的概念  以及接下来送入模型的feature的讨论

### metabolite profile数据，通用的，找QTL？
- [ ] 找不到？

- [ ] （HapMap  **maize HapMap？**  方法上的启发？）

### 调控网络数据
比如蛋白质相互作用以及RNA seq的共表达数据，**可以设计相应的调控网络的模型，当做feature**
- [ ] 可能与gene annotation一起用？
- [ ] **eQTL 用RNA-seq和genome数据计算？**


# 模型

## 现有常见模型
BLUP  Bayesian LMM
**Whole-Genome Regression (WGR) models** 应该是最有效的，


大家翻来覆去就是WGR，用BLUP或者LMM或者Bayesian，找feature就用这些模型筛选？算h2？
能用上基因信息吗？


## 非线性模型
如果加入的feature越来越多，可能我们就要抛掉Mixed Ridge线性模型，使用非线性的模型，比如处理基因间的相互作用等。
**Metric Regressor：** feature 不太多的时候还可以尝试

Mixed-Ridge类的线性模型，能够清楚地分析feature的权重，同时考虑亲缘关系和显著相关的SNP。我们如果使用非线性模型的话，
可以减去亲本的性状，这里的性状是**建立回归模型来找残差**，这个模型不直接减去父本母本的性状，否则不知道权重的话没法减。这样我们相当于只关注特殊配合力部分，用来挑feature， ~**找杂种优势。**~ （相当于每个亲本做了normalization，减去了GCA，所以如果最终为了预测性状的话，还需要把GCA部分加上）
对于ML模型来说，不同的样本的权重是一样的，对模型来说大多数的样本表现平均，因此先找出来残差可以让模型更好地关注。
之前会有**父本主导**的问题，现在没有关系了，对于预测性状而言，我们知道了所有的亲本的性状，把这项加入进去，就可以预测的不错，当然这对找杂种优势意义不大。
Trait2
[image:6BA2636B-5C09-477B-8418-CAB2B58FB658-733-0000A33AD1B69102/F845BA87-D415-45D4-999E-13310D78B6C9.png]
Trait3
[image:B7788C82-0D9C-4F8E-94D8-6B2B2D8A9ED9-733-0000A33C336CB33B/C0CD5188-BA07-42FB-BD82-14F35518F89E.png]
[image:4313C1C6-2D05-4165-8BA4-E65A39838767-733-0000A3541CD63780/download-6.png]
[image:1E9580DB-7A26-4AEB-B838-E14A90643945-733-0000A3541CF762B7/download-7.png]
[image:2A624F06-4446-41B6-9D49-E216A51A4A60-733-0000A3541D14825F/download-8.png]
**我们将利用可以使用的各种feature，来寻找把残差部分预测好的。真正有用的SNP，这样的模型才能发现杂种优势**

之前提的expert model，本质也是非线性模型，对不同的样本用不同的SNP，给不同的样本设置不同的权重，以及对基础模型进行组合。

### 性状联合预测 
比如对于性状的相关性，如果性状有相关性，互相可以提供信息，可以采用联合预测的方法。先计算性状间的相关性，看联合预测是否有意义。
如果几个性状相关性确实比较强，**多用几个性状的信息可以帮助预测。**
而且反过来也有意义，如果选出来的SNP可以预测的比较好，也可以说明选出的SNP更有意义。

efficient set tests for genetic analysis   特征选择和性状都可以联合预测，比如三性状选择同一组特征，或者同时预测几个性状  把协方差矩阵扩展到三维。**加公式和原理**，一共有20个性状，也许联合预测会有意义。



### 最终验证的样本
- [ ]  **最终测试验证的是jing724和zheng58与30个父本杂交的！**
这些亲本的SNP有，性状和更多数据能拿到吗？


## 如何能够用模型找到相关基因
**玉米的性状受到较多基因的控制？**
**如何确信挑出来的某一组feature确实是和trait相关的？**如果随机挑预测的就差不多是显然不对的。必须要排除掉亲缘关系后还能预测的比较好。前期的测试发现我们和其他人的模型其实还是靠亲缘关系预测的，如果解决好feature selection和模型设计，去除亲缘关系部分还可以预测好，挑出来的可能就是有效的。**从残差出发**


# 环境
## 目标
可塑性，基因型与环境关系。
维度 光照 温度，在某个条件下是好还是不好
预测phenotype的variance，找在不同环境下都稳健的品种？
影响株高和开花期的基因有很多

展示相关的图  分析可以怎么做   

## 相关基因
- [ ] ？？待调查

## 建模
环境的多个因素加上SNP，预测性状？
可以在现有的模型上改一下预测环境影响下的性状，但是考虑到环境只有五个点，数据太少。可以以样本作为考虑，每个样本都有五个配对的点，6210*5，这样相当于产生一个3维的tensor，可以定义如何运算。这样我们就用上了匹配的信息，可以预测同样的子代SNP在不同环境下的差别。



## 另一组
- [ ] 1）开发了基因组拼接、可视化比较基因组分析、基因表达调控网络构建与预测等一系列生物信息学软件和算法；2）十字花科盐碱生植物基因组进化及其抗逆基因的挖掘和功能验证；3）玉米胚乳早期发育调控网络的构建和玉米胚乳中基因组印迹机制的研究；4）小麦染色体缺失系转录组测序与小麦异源多倍体中不同亲本基因组间的相互作用的研究；5）应用人工智能中机器学习方法学体系在植物中进行大规模生物数据整合、调控网络构建与优质抗逆基因的预测和功能筛选。






